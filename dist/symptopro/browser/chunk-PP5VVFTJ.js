import{Fa as a,i,l as c,pa as m}from"./chunk-YALF7D37.js";var l=class extends Error{};l.prototype.name="InvalidTokenError";function d(o){return decodeURIComponent(atob(o).replace(/(.)/g,(r,e)=>{let t=e.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}function p(o){let r=o.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return d(r)}catch{return atob(r)}}function g(o,r){if(typeof o!="string")throw new l("Invalid token specified: must be a string");r||(r={});let e=r.header===!0?0:1,t=o.split(".")[e];if(typeof t!="string")throw new l(`Invalid token specified: missing part #${e+1}`);let s;try{s=p(t)}catch(n){throw new l(`Invalid token specified: invalid base64 for part #${e+1} (${n.message})`)}try{return JSON.parse(s)}catch(n){throw new l(`Invalid token specified: invalid json for part #${e+1} (${n.message})`)}}var w=(()=>{class o{constructor(e){this.http=e}login(e){return this.http.post(`${a.baseUrl}/Accounts/login`,e)}register(e){return this.http.post(`${a.baseUrl}/Accounts/register`,e)}verifyEmailConfirmation(e){return this.http.post(`${a.baseUrl}/Accounts/emailconfirmation`,e)}removeToken(){localStorage.removeItem("token"),localStorage.removeItem("imagePath"),localStorage.removeItem("id"),localStorage.removeItem("role"),localStorage.removeItem("fullName"),localStorage.removeItem("dateOfBirth"),localStorage.removeItem("userName"),localStorage.removeItem("phoneNumber"),localStorage.removeItem("gender"),localStorage.removeItem("email")}logout(){return this.removeToken(),this.http.post(`${a.baseUrl}/Accounts/SignOut`,{})}forgotPassword(e){return this.http.post(`${a.baseUrl}/Accounts/forgotpassword`,{email:e})}resetPassword(e){return this.http.post(`${a.baseUrl}/Accounts/resetpassword`,{email:e.email,token:e.token,newPassword:e.newPassword})}validateResetToken(e,t){return console.log(e),this.http.get(`${a.baseUrl}/Accounts/validateresettoken`,{params:{token:e,email:t}})}decodeToken(e){return g(e)}getUserRole(){if(typeof localStorage!==void 0){let e=localStorage.getItem("token");if(e)return this.decodeToken(e)["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]}return""}setUserData(e){if(typeof localStorage!==void 0){localStorage.setItem("token",e.token),localStorage.setItem("userName",e.userName),localStorage.setItem("fullName",e.fullName),localStorage.setItem("dateOfBirth",e.dateOfBirth),localStorage.setItem("gender",e.gender),localStorage.setItem("phoneNumber",e.phoneNumber),localStorage.setItem("imagePath",e.imagePath);let t=this.decodeToken(e.token);localStorage.setItem("id",t["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"]),localStorage.setItem("role",t["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]),localStorage.setItem("email",t["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"])}}isLoggedIn(){return typeof localStorage!==void 0?!!localStorage.getItem("token"):!1}getUserData(){return{id:localStorage.getItem("id"),role:localStorage.getItem("role"),fullName:localStorage.getItem("fullName"),dateOfBirth:localStorage.getItem("dateOfBirth"),userName:localStorage.getItem("userName"),phoneNumber:localStorage.getItem("phoneNumber"),gender:localStorage.getItem("gender"),token:localStorage.getItem("token"),imagePath:localStorage.getItem("imagePath"),email:localStorage.getItem("email")}}static{this.\u0275fac=function(t){return new(t||o)(c(m))}}static{this.\u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{w as a};
